<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>More Advanced Examples &#8212; PyMathProg 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Case: Subtour Elimination" href="subtour.html" />
    <link rel="prev" title="Miscellaneous functions" href="misc.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">PyMathProg 1.0 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="misc.html" title="Miscellaneous functions"
             accesskey="P">previous</a> |
          <a href="subtour.html" title="Case: Subtour Elimination"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="more-advanced-examples">
<h1>More Advanced Examples<a class="headerlink" href="#more-advanced-examples" title="Permalink to this headline">¶</a></h1>
<p>Here some more advanced examples are presented
with brief explanations. There are dozens more
examples in the <em>models</em> folder of the project
if you downloaded the zipped source files from
its <a class="reference external" href="https://sourceforge.net/projects/pymprog/">sourceforge project page</a>.
The source code of all the examples here are placed
in the <em>docs</em> folder of this project.
Some of these examples were originally written in
GNU MathProg by Andrew Makhorin (thanks to Andrew),
and were adopted into PyMathProg.</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#assign"><span class="std std-ref">Re-optimize the assignment</span></a></li>
<li><a class="reference internal" href="#dynaqueens"><span class="std std-ref">Interaction with queens</span></a></li>
<li><a class="reference internal" href="#tsp"><span class="std std-ref">The traveling sales man(TSP)</span></a></li>
<li><a class="reference internal" href="#zebra"><span class="std std-ref">Zebra: using string as index</span></a></li>
<li><a class="reference internal" href="#magic"><span class="std std-ref">Magic numbers</span></a></li>
<li><a class="reference internal" href="#sudoku"><span class="std std-ref">Sudoku: want some AI?</span></a></li>
<li><a class="reference internal" href="#sudoku2"><span class="std std-ref">Super Sudoku</span></a></li>
<li><a class="reference internal" href="#jobsched"><span class="std std-ref">Machine Scheduling</span></a></li>
<li><a class="reference internal" href="#revman"><span class="std std-ref">Scheduling for Revenue</span></a></li>
</ol>
<div class="section" id="re-optimize-the-assignment">
<span id="assign"></span><h2>Re-optimize the assignment<a class="headerlink" href="#re-optimize-the-assignment" title="Permalink to this headline">¶</a></h2>
<p>In this example, we first solve the assignment problem,
then we change one of the cost parameter, and
re-optimize. See how easily this is done in PyMathProg.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Assignment Problem</span>
<span class="c1"># Written in pymprog by Yingjie Lan &lt;ylan@umd.edu&gt;</span>

<span class="c1"># The assignment problem is one of the fundamental combinatorial</span>
<span class="c1">#   optimization problems.</span>

<span class="c1">#   In its most general form, the problem is as follows:</span>

<span class="c1">#   There are a number of agents and a number of tasks. Any agent can be</span>
<span class="c1">#   assigned to perform any task, incurring some cost that may vary</span>
<span class="c1">#   depending on the agent-task assignment. It is required to perform all</span>
<span class="c1">#   tasks by assigning exactly one agent to each task in such a way that</span>
<span class="c1">#   the total cost of the assignment is minimized.</span>
<span class="c1">#   (From Wikipedia, the free encyclopedia.)</span>

<span class="c1">#problem data</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># agents</span>
<span class="n">M</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="c1">#set of agents</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># tasks</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#set of tasks</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span> <span class="c1">#cost</span>
<span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span>
<span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
<span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">37</span><span class="p">),</span>
<span class="p">(</span><span class="mi">34</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span>
<span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">48</span><span class="p">),</span>
<span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">46</span><span class="p">),</span>
<span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">24</span><span class="p">),</span>
<span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">43</span><span class="p">)]</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">begin</span><span class="p">(</span><span class="s2">&quot;assign&quot;</span><span class="p">)</span>
<span class="c1">#verbose(True) # for model output</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">iprod</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="c1"># Descartan product </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># assignment decisions</span>
<span class="c1"># use parameters for automatic model update</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">par</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="c1"># when their values change</span>
<span class="n">minimize</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">A</span><span class="p">))</span>
<span class="c1"># each agent is assigned to at most one task</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span> 
<span class="c1"># each task must be assigned to somebody</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">M</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="k">def</span> <span class="nf">report</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total Cost = </span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">vobj</span><span class="p">())</span>
    <span class="n">assign</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">M</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">N</span> 
                <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">assign</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agent </span><span class="si">%d</span><span class="s2"> gets Task </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">assign</span>

<span class="n">solve</span><span class="p">()</span>
<span class="n">assign</span> <span class="o">=</span> <span class="n">report</span><span class="p">()</span>
<span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="o">=</span> <span class="n">assign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># model will be updated for the value change</span>
<span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">10</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Set cost c</span><span class="si">%r</span><span class="s2"> to higher value </span><span class="si">%r</span><span class="s2">&quot;</span><span class="o">%</span>
          <span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>

<span class="n">solve</span><span class="p">()</span>
<span class="n">report</span><span class="p">()</span>
<span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Below is the output, note how the optimal assignment
changed after increasing the cost, and how the second
time of solving the problem seems much easier.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>GLPK Simplex Optimizer, v4.60
16 rows, 64 columns, 128 non-zeros
      0: obj =   0.000000000e+00 inf =   8.000e+00 (8)
      8: obj =   1.750000000e+02 inf =   0.000e+00 (0)
*    24: obj =   7.600000000e+01 inf =   0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Total Cost = 76
Agent 0 gets Task 0
Agent 1 gets Task 7
Agent 2 gets Task 6
Agent 3 gets Task 4
Agent 4 gets Task 1
Agent 5 gets Task 5
Agent 6 gets Task 3
Agent 7 gets Task 2
Set cost c[0, 0] to higher value 23
GLPK Simplex Optimizer, v4.60
16 rows, 64 columns, 128 non-zeros
*    25: obj =   7.800000000e+01 inf =   0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Total Cost = 78
Agent 0 gets Task 7
Agent 1 gets Task 0
Agent 2 gets Task 6
Agent 3 gets Task 4
Agent 4 gets Task 1
Agent 5 gets Task 5
Agent 6 gets Task 3
Agent 7 gets Task 2
</pre></div>
</div>
</div>
<div class="section" id="interaction-with-queens">
<span id="dynaqueens"></span><h2>Interaction with queens<a class="headerlink" href="#interaction-with-queens" title="Permalink to this headline">¶</a></h2>
<p>This example will randomly pick a board size and then
randomly place some queens on the board.
The rest of the queens are then placed
by the LP program to see if all queens
can be placed without attaching each other.
If that&#8217;s impossible, then the random positions
are said to be bad. Note that in that LP,
no objective function is needed.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="n">model</span><span class="p">,</span> <span class="n">iprod</span><span class="p">,</span> <span class="n">glpk</span>

<span class="c1"># The Queens Problem is to place as many queens as possible on the nxn</span>
<span class="c1">#   chess board in a way that they do not fight</span>
<span class="c1">#   each other. This problem is probably as old as the chess game itself,</span>
<span class="c1">#   and thus its origin is not known, but it is known that Gauss studied</span>
<span class="c1">#   this problem.</span>

<span class="k">def</span> <span class="nf">queens</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="c1"># n: size of the chess board</span>
   <span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s1">&#39;queens&#39;</span><span class="p">)</span>
   <span class="n">iboard</span> <span class="o">=</span> <span class="n">iprod</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="c1">#create indices</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">iboard</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="c1">#create variables</span>
   <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">iboard</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="c1"># row-wise</span>
       <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span>
   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="c1"># column-wise</span>
       <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span>
   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># diagonal &#39;\&#39; wise</span>
       <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">iboard</span> <span class="k">if</span> <span class="n">i</span><span class="o">-</span><span class="n">j</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> 
   <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span> <span class="c1"># anti-diagonal &#39;/&#39; wise</span>
       <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">iboard</span> <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="n">j</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> 
   <span class="k">return</span> <span class="n">p</span><span class="p">,</span><span class="n">x</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Board size: </span><span class="si">%i</span><span class="s2"> X </span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">randpair</span><span class="p">():</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span><span class="o">%</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">//</span><span class="n">n</span>
<span class="k">def</span> <span class="nf">randpos</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">randpair</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>
       <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">))</span><span class="o">&lt;</span><span class="n">k</span><span class="p">:</span> <span class="k">continue</span>
       <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">))</span><span class="o">&lt;</span><span class="n">k</span><span class="p">:</span> <span class="k">continue</span>
       <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">))</span><span class="o">&lt;</span><span class="n">k</span><span class="p">:</span> <span class="k">continue</span>
       <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">))</span><span class="o">&lt;</span><span class="n">k</span><span class="p">:</span> <span class="k">continue</span>
       <span class="k">return</span> <span class="n">pos</span>

<span class="n">p</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">queens</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">try_out</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">:</span>
     <span class="n">x</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
   <span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">:</span>
     <span class="n">x</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">!=</span> <span class="n">glpk</span><span class="o">.</span><span class="n">GLP_OPT</span>

<span class="n">p</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">msg_lev</span><span class="o">=</span><span class="n">glpk</span><span class="o">.</span><span class="n">GLP_MSG_OFF</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">msg_lev</span><span class="o">=</span><span class="n">glpk</span><span class="o">.</span><span class="n">GLP_MSG_OFF</span><span class="p">)</span>

<span class="n">bads</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;randomly put </span><span class="si">%i</span><span class="s2"> queens.&quot;</span><span class="o">%</span><span class="n">k</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">randpos</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="c1">#print(pos)</span>
    <span class="n">bads</span> <span class="o">+=</span> <span class="n">try_out</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;found </span><span class="si">%i</span><span class="s1"> bad positions out of 100&#39;</span><span class="o">%</span><span class="n">bads</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="the-traveling-sales-man-tsp">
<span id="tsp"></span><h2>The traveling sales man(TSP)<a class="headerlink" href="#the-traveling-sales-man-tsp" title="Permalink to this headline">¶</a></h2>
<p>Really, the too well known problem.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># TSP, Traveling Salesman Problem</span>
<span class="c1"># Model in pymprog by Yingjie Lan &lt;ylan@pku.edu.cn&gt;</span>

<span class="c1"># The Traveling Salesman Problem (TSP) is a famous problem.</span>
<span class="c1">#   Let a directed graph G = (V, E) be given, where V = {1, ..., n} is</span>
<span class="c1">#   a set of nodes, E &lt;subset of&gt; V x V is a set of arcs. Let also each arc</span>
<span class="c1">#   e = (i,j) be assigned a number c[i,j], which is the length of the</span>
<span class="c1">#   arc e. The problem is to find a closed path of minimal length going</span>
<span class="c1">#   through each node of G exactly once. </span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1">#number of nodes</span>
<span class="n">V</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#set of notes</span>
<span class="c1">#cost or each arc, format: (start, end):cost</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">509</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">501</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">312</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">1019</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">736</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">656</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span> <span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">1039</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">726</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">2314</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">479</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">448</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">479</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">619</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">150</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">509</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">126</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">474</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">1526</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">1226</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">1133</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">532</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">1449</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">1122</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">2789</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">958</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">941</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">978</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">1127</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">542</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">501</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">126</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">541</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">1516</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">1184</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">1084</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">536</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">1371</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">1045</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">2728</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">913</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">904</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">946</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">1115</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">499</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">312</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">474</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">541</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">1157</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">980</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">919</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">271</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">1333</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">1029</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">2553</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">751</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">704</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">720</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">783</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">455</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">1019</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">1526</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">1516</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">1157</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">478</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">583</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">996</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">858</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">855</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1504</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">677</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">651</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">600</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">401</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">1033</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">736</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">1226</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">1184</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">980</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">478</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">115</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">740</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">470</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">379</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1581</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">271</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">289</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">261</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">308</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">687</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">656</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">1133</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">1084</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">919</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">583</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">115</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">667</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">455</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">288</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1661</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">177</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">216</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">207</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">343</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">592</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span> <span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">532</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">536</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">271</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">996</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">740</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">667</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">1066</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">759</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">2320</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">493</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">454</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">479</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">598</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">206</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">1039</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">1449</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">1371</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">1333</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">858</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">470</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">455</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">1066</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">328</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1387</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">591</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">650</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">656</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">776</span><span class="p">,</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">933</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">726</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">1122</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">1045</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">1029</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">855</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">379</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">288</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">759</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">328</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1697</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">333</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">400</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">427</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">622</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">610</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">2314</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">2789</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">2728</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">2553</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">1504</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">1581</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">1661</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">2320</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">1387</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">1697</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">1838</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">1868</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">1841</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">1789</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">2248</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">479</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">958</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">913</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">751</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">677</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">271</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">177</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">493</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">591</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">333</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1838</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span> <span class="mi">68</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">105</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">336</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">417</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">448</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">941</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">904</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">704</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">651</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">289</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">216</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">454</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">650</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">400</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1868</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span> <span class="mi">68</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span> <span class="mi">52</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">287</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">406</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">479</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">978</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">946</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">720</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">600</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">261</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">207</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">479</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">656</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">427</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1841</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">105</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span> <span class="mi">52</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">237</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">449</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">619</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">1127</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">1115</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">783</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">401</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">308</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">343</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">598</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">776</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">622</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">1789</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">336</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">287</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">237</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span><span class="mi">636</span><span class="p">,</span> 
<span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">150</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">542</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">499</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span><span class="mi">455</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span><span class="mi">1033</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">687</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="mi">592</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span><span class="mi">206</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span><span class="mi">933</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span><span class="mi">610</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span><span class="mi">2248</span><span class="p">,</span> 
     <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span><span class="mi">417</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span><span class="mi">406</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span><span class="mi">449</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span><span class="mi">636</span><span class="p">}</span>
<span class="c1">#set of arcs: (i,j) repr an arc from i to j</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="n">model</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">&quot;tsp&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="c1"># created over E.</span>
<span class="c1">#minize the total travel distance</span>
<span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">E</span><span class="p">),</span> <span class="s1">&#39;totaldist&#39;</span><span class="p">)</span>
<span class="c1">#subject to: leave each city exactly once</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">V</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">E</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 
<span class="c1">#subject to: enter each city exactly once</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">V</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="n">E</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="c1">#some flow constraints to eliminate subtours.</span>
<span class="c1">#y: the number of cars carried: city 1 has n cars.</span>
<span class="c1">#exactly one car will be distributed to each city.</span>
<span class="n">y</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span> 
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">E</span><span class="p">:</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> 
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span> <span class="p">(</span>
  <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">V</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">E</span><span class="p">)</span> <span class="c1"># cars out</span>
  <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">V</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="n">E</span><span class="p">)</span> <span class="c1"># cars in</span>
  <span class="o">==</span>  <span class="p">(</span><span class="n">n</span> <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1">#solve as LP only.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;simplex done: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">p</span><span class="o">.</span><span class="n">status</span><span class="p">())</span>
<span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1">#solve the IP problem</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">vobj</span><span class="p">())</span>
<span class="n">tour</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">E</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;.</span><span class="mi">5</span><span class="p">]</span>
<span class="n">cat</span><span class="p">,</span> <span class="n">car</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is the optimal tour with [cars carried]:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span> 
   <span class="nb">print</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">tour</span><span class="p">:</span> 
      <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">cat</span><span class="p">:</span> 
         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">%g</span><span class="s2">]&quot;</span><span class="o">%</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
         <span class="n">cat</span><span class="o">=</span><span class="n">j</span>
         <span class="k">break</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>

</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="zebra-using-string-as-index">
<span id="zebra"></span><h2>Zebra: using string as index<a class="headerlink" href="#zebra-using-string-as-index" title="Permalink to this headline">¶</a></h2>
<p>A logic puzzle, see how strings are
used as indices here to enhance the
readability of the model.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># ZEBRA, Who Owns the Zebra? </span>
<span class="c1"># Adapted from GLPK to pymprog by Yingjie Lan &lt;ylan@pku.edu.cn&gt;</span>

<span class="c1">########################################################################</span>
<span class="c1">#  The Zebra Puzzle is a well-known logic puzzle.</span>
<span class="c1">#</span>
<span class="c1">#  It is often called &quot;Einstein&#39;s Puzzle&quot; or &quot;Einstein&#39;s Riddle&quot;</span>
<span class="c1">#  because it is said to have been invented by Albert Einstein as a boy,</span>
<span class="c1">#  with the common claim that Einstein said &quot;only 2 percent of the</span>
<span class="c1">#  world&#39;s population can solve&quot;. It is also sometimes attributed to</span>
<span class="c1">#  Lewis Carroll. However, there is no known evidence for Einstein&#39;s or</span>
<span class="c1">#  Carroll&#39;s authorship.</span>
<span class="c1">#</span>
<span class="c1">#  There are several versions of this puzzle. The version below is</span>
<span class="c1">#  quoted from the first known publication in Life International</span>
<span class="c1">#  magazine on December 17, 1962.</span>
<span class="c1">#</span>
<span class="c1">#   1. There are five houses.</span>
<span class="c1">#   2. The Englishman lives in the red house.</span>
<span class="c1">#   3. The Spaniard owns the dog.</span>
<span class="c1">#   4. Coffee is drunk in the green house.</span>
<span class="c1">#   5. The Ukrainian drinks tea.</span>
<span class="c1">#   6. The green house is immediately to the right of the ivory house.</span>
<span class="c1">#   7. The Old Gold smoker owns snails.</span>
<span class="c1">#   8. Kools are smoked in the yellow house.</span>
<span class="c1">#   9. Milk is drunk in the middle house.</span>
<span class="c1">#  10. The Norwegian lives in the first house.</span>
<span class="c1">#  11. The man who smokes Chesterfields lives in the house next to the</span>
<span class="c1">#      man with the fox.</span>
<span class="c1">#  12. Kools are smoked in the house next to the house where the horse</span>
<span class="c1">#      is kept.</span>
<span class="c1">#  13. The Lucky Strike smoker drinks orange juice.</span>
<span class="c1">#  14. The Japanese smokes Parliaments.</span>
<span class="c1">#  15. The Norwegian lives next to the blue house.</span>
<span class="c1">#</span>
<span class="c1">#  Now, who drinks water? Who owns the zebra?</span>
<span class="c1">#</span>
<span class="c1">#  In the interest of clarity, it must be added that each of the five</span>
<span class="c1">#  houses is painted a different color, and their inhabitants are of</span>
<span class="c1">#  different national extractions, own different pets, drink different</span>
<span class="c1">#  beverages and smoke different brands of American cigarettes. One</span>
<span class="c1">#  other thing: In statement 6, right means your right.</span>
<span class="c1">#</span>
<span class="c1">#  (From Wikipedia, the free encyclopedia.)</span>
<span class="c1">########################################################################</span>

<span class="n">HOUSE</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="n">COLOR</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;ivory&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

<span class="n">NATIONALITY</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Englishman&quot;</span><span class="p">,</span> <span class="s2">&quot;Japanese&quot;</span><span class="p">,</span> <span class="s2">&quot;Norwegian&quot;</span><span class="p">,</span>
               <span class="s2">&quot;Spaniard&quot;</span><span class="p">,</span> <span class="s2">&quot;Ukranian&quot;</span><span class="p">)</span>

<span class="n">DRINK</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;coffee&quot;</span><span class="p">,</span> <span class="s2">&quot;milk&quot;</span><span class="p">,</span> <span class="s2">&quot;orange_juice&quot;</span><span class="p">,</span> <span class="s2">&quot;tea&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">)</span>

<span class="n">SMOKE</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Chesterfield&quot;</span><span class="p">,</span> <span class="s2">&quot;Kools&quot;</span><span class="p">,</span> <span class="s2">&quot;Lucky_Strike&quot;</span><span class="p">,</span> 
          <span class="s2">&quot;Old_Gold&quot;</span><span class="p">,</span> <span class="s2">&quot;Parliament&quot;</span><span class="p">)</span>

<span class="n">PET</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;fox&quot;</span><span class="p">,</span> <span class="s2">&quot;horse&quot;</span><span class="p">,</span> <span class="s2">&quot;snails&quot;</span><span class="p">,</span> <span class="s2">&quot;zebra&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="o">*</span>
<span class="c1">#Uncomment to forbid comparison with a variable as an expression.</span>
<span class="c1">#pymprog.variable.comparable=False</span>
<span class="n">zeb</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">&quot;zebra&quot;</span><span class="p">)</span>

<span class="n">color</span><span class="o">=</span><span class="n">zeb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">iprod</span><span class="p">(</span><span class="n">HOUSE</span><span class="p">,</span> <span class="n">COLOR</span><span class="p">),</span> <span class="nb">bool</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">COLOR</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">COLOR</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>

<span class="n">nationality</span><span class="o">=</span><span class="n">zeb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;nation&#39;</span><span class="p">,</span> <span class="n">iprod</span><span class="p">(</span><span class="n">HOUSE</span><span class="p">,</span> <span class="n">NATIONALITY</span><span class="p">),</span> <span class="nb">bool</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">NATIONALITY</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">NATIONALITY</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="n">drink</span><span class="o">=</span><span class="n">zeb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;drink&#39;</span><span class="p">,</span> <span class="n">iprod</span><span class="p">(</span><span class="n">HOUSE</span><span class="p">,</span> <span class="n">DRINK</span><span class="p">),</span> <span class="nb">bool</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">drink</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">DRINK</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">DRINK</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">drink</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="n">smoke</span><span class="o">=</span><span class="n">zeb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;smoke&#39;</span><span class="p">,</span><span class="n">iprod</span><span class="p">(</span><span class="n">HOUSE</span><span class="p">,</span> <span class="n">SMOKE</span><span class="p">),</span><span class="nb">bool</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">SMOKE</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">SMOKE</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="n">pet</span><span class="o">=</span><span class="n">zeb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;pet&#39;</span><span class="p">,</span> <span class="n">iprod</span><span class="p">(</span><span class="n">HOUSE</span><span class="p">,</span> <span class="n">PET</span><span class="p">),</span><span class="nb">bool</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">PET</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">PET</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="c1">## the Englishman lives in the red house */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Englishman&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">]</span> 

<span class="c1">## the Spaniard owns the dog */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Spaniard&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;dog&quot;</span><span class="p">]</span> 

<span class="c1">## coffee is drunk in the green house */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="n">drink</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;coffee&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">]</span> 

<span class="c1">## the Ukrainian drinks tea */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Ukranian&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">drink</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;tea&quot;</span><span class="p">]</span> 

<span class="c1">## the green house is immediately to the right of the ivory house */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span>
   <span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;ivory&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">h</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">## the Old Gold smoker owns snails */</span>
<span class="k">for</span>  <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Old_Gold&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;snails&quot;</span><span class="p">]</span> 

<span class="c1">## Kools are smoked in the yellow house */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span> <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Kools&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;yellow&quot;</span><span class="p">]</span> 

<span class="c1">## milk is drunk in the middle house */</span>
<span class="n">drink</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;milk&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>

<span class="c1">## the Norwegian lives in the first house */</span>
<span class="n">nationality</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;Norwegian&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>

<span class="c1"># the man who smokes Chesterfields lives in the house </span>
<span class="c1">#   next to the man with the fox */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:(</span>
   <span class="mi">1</span> <span class="o">-</span> <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Chesterfield&quot;</span><span class="p">]</span> <span class="o">+</span>
   <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;fox&quot;</span><span class="p">])</span> <span class="o">+</span>
   <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">5</span> <span class="k">else</span> <span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;fox&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">)</span>

<span class="c1"># Kools are smoked in the house next to the house </span>
<span class="c1">#   where the horse is kept */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:(</span>
   <span class="mi">1</span> <span class="o">-</span> <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Kools&quot;</span><span class="p">]</span> <span class="o">+</span>
   <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;horse&quot;</span><span class="p">])</span> <span class="o">+</span>
   <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">5</span> <span class="k">else</span> <span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;horse&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">## the Lucky Strike smoker drinks orange juice */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span>
   <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Lucky_Strike&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">drink</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;orange_juice&quot;</span><span class="p">]</span>


<span class="c1">## the Japanese smokes Parliaments */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span>
   <span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Japanese&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Parliament&quot;</span><span class="p">]</span>


<span class="c1">#zeb.verb = True</span>
<span class="c1">## the Norwegian lives next to the blue house */</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:(</span>
   <span class="mi">1</span> <span class="o">-</span> <span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="s2">&quot;Norwegian&quot;</span><span class="p">]</span> <span class="o">+</span>
   <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;blue&quot;</span><span class="p">])</span> <span class="o">+</span>
   <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">5</span> <span class="k">else</span> <span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;blue&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">zeb</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">answ</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">COLOR</span><span class="p">:</span> 
      <span class="k">if</span> <span class="n">color</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">NATIONALITY</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">nationality</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
   <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">DRINK</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">drink</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
   <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">SMOKE</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">smoke</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
   <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">PET</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">pet</span><span class="p">[</span><span class="n">h</span><span class="p">,</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
   <span class="k">return</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HOUSE  COLOR   NATIONALITY  DRINK         SMOKE         PET&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">HOUSE</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5d</span><span class="s2">  </span><span class="si">%-6s</span><span class="s2">  </span><span class="si">%-11s</span><span class="s2">  </span><span class="si">%-12s</span><span class="s2">  </span><span class="si">%-12s</span><span class="s2">  </span><span class="si">%-6s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">answ</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="n">zeb</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="magic-numbers">
<span id="magic"></span><h2>Magic numbers<a class="headerlink" href="#magic-numbers" title="Permalink to this headline">¶</a></h2>
<p>Magic numbers, a very interesting problem.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;In recreational mathematics, a magic square of order n is an</span>
<span class="sd">   arrangement of n^2 numbers, usually distinct integers, in a square,</span>
<span class="sd">   such that n numbers in all rows, all columns, and both diagonals sum</span>
<span class="sd">   to the same constant. A normal magic square contains the integers</span>
<span class="sd">   from 1 to n^2.</span>

<span class="sd">   (From Wikipedia, the free encyclopedia.)</span>

<span class="sd">When n=5, we have:</span>

<span class="sd">the magic sum must be:  65</span>
<span class="sd">solver status: opt</span>
<span class="sd">10  2  4 24 25</span>
<span class="sd"> 9 11 20  6 19</span>
<span class="sd">22 14 16  8  5</span>
<span class="sd">23 17  7 15  3</span>
<span class="sd"> 1 21 18 12 13&quot;&quot;&quot;</span>

<span class="c1"># square order </span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># set of numbers</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#the magic sum:</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">//</span><span class="n">n</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the magic sum must be: </span><span class="si">%r</span><span class="s2"> &quot;</span><span class="o">%</span> <span class="n">s</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span>  <span class="n">model</span><span class="p">,</span> <span class="n">iprod</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">iprod</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">iprod</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s1">&#39;magic&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="c1">#x[i,j,k] = 1 means that cell (i,j) contains integer k</span>

<span class="c1">#each cell must be assigned exactly one integer</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="c1">#each integer must be assigned exactly to one cell</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">S</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> 

<span class="c1">#the sum in each row must be the magic sum </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
  <span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">==</span><span class="n">s</span>

<span class="c1">#the sum in each column must be the magic sum </span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
  <span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">==</span><span class="n">s</span>

<span class="c1">#the sum in the diagonal must be the magic sum</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">==</span><span class="n">s</span>

<span class="c1">#the sum in the co-diagonal must be the magic sum</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span><span class="o">==</span><span class="n">s</span>

<span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;solver status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">p</span><span class="o">.</span><span class="n">status</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%2g</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">N</span><span class="p">)</span> 
             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">p</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sudoku-want-some-ai">
<span id="sudoku"></span><h2>Sudoku: want some AI?<a class="headerlink" href="#sudoku-want-some-ai" title="Permalink to this headline">¶</a></h2>
<p>Do you play Sudoku?
This program might help you crack a Sudoku in seconds ;).</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># SUDOKU, Number Placement Puzzle </span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="sd">&quot;&quot;&quot;Sudoku, also known as Number Place, is a logic-based placement</span>
<span class="sd">   puzzle. The aim of the canonical puzzle is to enter a numerical</span>
<span class="sd">   digit from 1 through 9 in each cell of a 9x9 grid made up of 3x3</span>
<span class="sd">   subgrids (called &quot;regions&quot;), starting with various digits given in</span>
<span class="sd">   some cells (the &quot;givens&quot;). Each row, column, and region must contain</span>
<span class="sd">   only one instance of each numeral.</span>

<span class="sd">   Example:</span>

<span class="sd">   +-------+-------+-------+</span>
<span class="sd">   | 5 3 . | . 7 . | . . . |</span>
<span class="sd">   | 6 . . | 1 9 5 | . . . |</span>
<span class="sd">   | . 9 8 | . . . | . 6 . |</span>
<span class="sd">   +-------+-------+-------+</span>
<span class="sd">   | 8 . . | . 6 . | . . 3 |</span>
<span class="sd">   | 4 . . | 8 . 3 | . . 1 |</span>
<span class="sd">   | 7 . . | . 2 . | . . 6 |</span>
<span class="sd">   +-------+-------+-------+</span>
<span class="sd">   | . 6 . | . . . | 2 8 . |</span>
<span class="sd">   | . . . | 4 1 9 | . . 5 |</span>
<span class="sd">   | . . . | . 8 . | . 7 9 |</span>
<span class="sd">   +-------+-------+-------+</span>

<span class="sd">   (From Wikipedia, the free encyclopedia.)&quot;&quot;&quot;</span>

<span class="c1"># the &quot;givens&quot; </span>
<span class="n">g</span> <span class="o">=</span><span class="p">(</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
<span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="n">model</span><span class="p">,</span> <span class="n">iprod</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">&quot;sudoku&quot;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">iprod</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">K</span><span class="p">)</span> <span class="c1">#create Indice tuples</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="c1">#x[i,j,k] = 1 means cell [i,j] is assigned number k </span>
<span class="c1">#assign pre-defined numbers using the &quot;givens&quot;</span>
<span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> 
       <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="n">T</span> <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">]</span>

<span class="c1">#each cell must be assigned exactly one number</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">]</span>

<span class="c1">#cells in the same row must be assigned distinct numbers</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>

<span class="c1">#cells in the same column must be assigned distinct numbers</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>

<span class="c1">#cells in \-diagonal</span>
<span class="c1">#p.st([sum(x[i,i,k] for i in I)==1 for k in K])</span>

<span class="c1">#cells in /-diagonal</span>
<span class="c1">#p.st([sum(x[i,10-i,k] for i in I)==1 for k in K])</span>

<span class="c1">#cells in the same region must be assigned distinct numbers</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">r</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">==</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>
   
<span class="c1">#there is no need for an objective function here</span>

<span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; +-------+-------+-------+&quot;</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">9</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; +-------+-------+-------+&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="super-sudoku">
<span id="sudoku2"></span><h2>Super Sudoku<a class="headerlink" href="#super-sudoku" title="Permalink to this headline">¶</a></h2>
<p>This example will provide a sample Super Sudoku:
in addition to satisfying all the requirements
of Sudoku, Super Sudoku also requires that the
elements in each diagonal must be distinct,
below is a sample Super Sudoku obtained by the
code provided afterwards:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+-------+-------+-------+</span>
<span class="o">|</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">3</span> <span class="o">|</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">5</span> <span class="o">|</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">9</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="o">|</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="o">|</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">3</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="o">|</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">3</span> <span class="o">|</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="o">|</span>
<span class="o">+-------+-------+-------+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">6</span> <span class="o">|</span> <span class="mi">7</span> <span class="mi">9</span> <span class="mi">8</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">9</span> <span class="mi">7</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">1</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">9</span> <span class="mi">7</span> <span class="mi">5</span> <span class="o">|</span> <span class="mi">8</span> <span class="mi">4</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">3</span> <span class="mi">6</span> <span class="mi">2</span> <span class="o">|</span>
<span class="o">+-------+-------+-------+</span>
<span class="o">|</span> <span class="mi">8</span> <span class="mi">4</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">1</span> <span class="mi">9</span> <span class="mi">7</span> <span class="o">|</span> <span class="mi">6</span> <span class="mi">3</span> <span class="mi">5</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">6</span> <span class="mi">3</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">9</span> <span class="mi">8</span> <span class="mi">7</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">5</span> <span class="mi">9</span> <span class="mi">7</span> <span class="o">|</span> <span class="mi">6</span> <span class="mi">3</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="o">|</span>
<span class="o">+-------+-------+-------+</span>
</pre></div>
</div>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="sd">&quot;&quot;&quot;Sudoku, also known as Number Place, is a logic-based placement</span>
<span class="sd">   puzzle. The aim of the canonical puzzle is to enter a numerical</span>
<span class="sd">   digit from 1 through 9 in each cell of a 9x9 grid made up of 3x3</span>
<span class="sd">   subgrids (called &quot;regions&quot;), starting with various digits given in</span>
<span class="sd">   some cells (the &quot;givens&quot;). Each row, column, and region must contain</span>
<span class="sd">   only one instance of each numeral.</span>

<span class="sd">   (From Wikipedia, the free encyclopedia.)</span>

<span class="sd">   This example will provide a sample Super Sudoku:</span>
<span class="sd">   in addition to satisfying all the requirements </span>
<span class="sd">   of Sudoku, Super Sudoku also requires that the</span>
<span class="sd">   elements in each diagonal must be distinct.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="o">*</span>        <span class="c1"># Import the module</span>
<span class="n">begin</span><span class="p">(</span><span class="s2">&quot;ssudoku&quot;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">iprod</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">K</span><span class="p">)</span> <span class="c1">#create Indice tuples</span>
<span class="c1">#x[i,j,k] = 1 means cell [i,j] is assigned number k </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="c1">#binary vars</span>
<span class="c1">#each cell must be assigned exactly one number</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">]</span>
<span class="c1">#cells in the same row must be assigned distinct numbers</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>
<span class="c1">#cells in the same column must be assigned distinct numbers</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>
<span class="c1">#cells in the same region must be assigned distinct numbers</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">r</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">==</span><span class="mi">1</span>
 <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>

<span class="c1">#cells in \-diagonal</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>

<span class="c1">#cells in /-diagonal</span>
<span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>

<span class="c1">#there is no need for an objective function here</span>

<span class="n">solve</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; +-------+-------+-------+&quot;</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">9</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; +-------+-------+-------+&quot;</span><span class="p">)</span>

<span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="machine-scheduling">
<span id="jobsched"></span><h2>Machine Scheduling<a class="headerlink" href="#machine-scheduling" title="Permalink to this headline">¶</a></h2>
<p>Schedule jobs on a single machine, given the duration,
earliest start time, and the latest finish time
of each job. Jobs can not be interrupted, and
the machine can only handle one job at one time.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">N</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">]</span>

<span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#duration of each job</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#earliest start</span>
<span class="n">U</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="c1">#latest finish</span>

<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">begin</span><span class="p">(</span><span class="s2">&quot;job-scheduling&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>  <span class="n">N</span><span class="p">)</span> <span class="c1">#start time</span>
<span class="c1">#MD[i,j] = (D[i]+D[j])/2.0</span>
<span class="c1">#T[i] = x[i] + D[i]</span>
<span class="c1">#y[i,j]&lt;= |T[i]-x[j]-MD[i,j]|</span>
<span class="c1">#y[i,j] &lt; MD[i,j] &lt;==&gt; overlap betw jobs i,j</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>  <span class="n">M</span> <span class="p">)</span> 
<span class="c1">#w[i,j]: the &#39;OR&#39; for |T[i]-x[j]-MD[i,j]|</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="c1"># z[i,j] &gt;= MD[i,j] - y[i,j]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span>  <span class="n">M</span> <span class="p">)</span>

<span class="n">minimize</span><span class="p">(</span> <span class="nb">sum</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">M</span><span class="p">)</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
   <span class="p">((</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> 
       <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

   <span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span>
       <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

   <span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> 

<span class="c1">#set bounds on x</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span>
   <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 

<span class="c1">#another way to enforce no overlapping:</span>
<span class="c1">#</span>
<span class="c1"># x[i] &gt;= T[j] or x[j] &gt;= T[i]</span>
<span class="c1">#</span>
<span class="c1"># Which can be formulated as:</span>
<span class="c1">#</span>
<span class="c1"># x[i] + (U[j]-L[i])*w[i,j]&gt;= x[j]+D[j]</span>
<span class="c1"># x[j] + (U[i]-L[j])*(1-w[i,j]) &gt;= x[i]+D[i]</span>

<span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;status: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">status</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;overlap: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">vobj</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;schedule:&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span>
   <span class="n">start</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;job </span><span class="si">%i</span><span class="s2">: </span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

</pre></div>
</td></tr></table></div>
<p>The output schedule is as follows (your run
may not be the same, as the data is randomly
generated &#8211; you might even get infeasible
problem instances):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Duration</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">Earliest</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">Latest</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">38</span><span class="p">]</span>
<span class="n">status</span><span class="p">:</span> <span class="n">opt</span>
<span class="n">schedule</span><span class="p">:</span>
<span class="n">job</span> <span class="mi">0</span><span class="p">:</span> <span class="mf">13.0</span> <span class="mf">20.0</span>
<span class="n">job</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">20.0</span> <span class="mf">24.0</span>
<span class="n">job</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">27.0</span> <span class="mf">28.0</span>
<span class="n">job</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">31.0</span> <span class="mf">38.0</span>
</pre></div>
</div>
</div>
<div class="section" id="scheduling-for-revenue">
<span id="revman"></span><h2>Scheduling for Revenue<a class="headerlink" href="#scheduling-for-revenue" title="Permalink to this headline">¶</a></h2>
<p>The same scheduling problem as above, but add a new
spin to the problem: when it is not feasible to
accept all jobs, try accept those that will maximize
the total revenue.</p>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">random</span> <span class="k">import</span> <span class="n">Random</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">Random</span><span class="p">()</span>

<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">]</span> <span class="c1"># processing time</span>
<span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">]</span> <span class="c1"># revenue</span>
<span class="n">tt</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">D</span><span class="p">);</span> <span class="n">tt</span> <span class="o">-=</span> <span class="n">tt</span><span class="o">//</span><span class="mi">5</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">tt</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">]</span> <span class="c1"># arrival time</span>
<span class="n">U</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">]</span> <span class="c1"># duedate</span>

<span class="c1">#overlapping jobs</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">N</span> 
   <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span> <span class="ow">and</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> 

<span class="c1">#i must preceed j and they could bump into each other</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">N</span> <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="n">j</span>
   <span class="ow">and</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
   <span class="c1">#lastest start &lt; earliest finish</span>
   <span class="ow">and</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>


<span class="kn">from</span> <span class="nn">pymprog</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">begin</span><span class="p">(</span><span class="s2">&quot;job-scheduling&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">N</span> <span class="p">)</span> <span class="c1">#start time</span>
<span class="c1">#MD[i,j] = (D[i]+D[j])/2.0</span>
<span class="c1">#T[i] = x[i] + D[i]</span>
<span class="c1">#y[i,j]&lt;= |T[i]-x[j]-MD[i,j]|</span>
<span class="c1">#y[i,j] &lt; MD[i,j] &lt;==&gt; overlap betw jobs i,j</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> 
<span class="c1">#w[i,j]: the &#39;OR&#39; for |T[i]-x[j]-MD[i,j]|</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="c1"># z[i,j] &gt;= MD[i,j] - y[i,j]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="p">)</span>
<span class="c1">#u[i] = 1 iff job i is scheduled.</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>

<span class="n">maximize</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">),</span> <span class="s1">&#39;revenue&#39;</span><span class="p">)</span>

<span class="nb">sum</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1">#single</span>
<span class="c1">#w[i,j]=0  ==&gt; </span>
<span class="c1">#x[j] + D[j]/2 &gt;= x[i]+D[i]/2 + y[i,j]</span>
<span class="c1">#That is: i preceed j when w[i,j]=0.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
   <span class="p">((</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> 
        <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

   <span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

   <span class="p">((</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> 
       <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">P</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">P</span><span class="p">:</span>
       <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">P</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#set bounds on x</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span>
   <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 


<span class="n">solver</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> 
    <span class="c1">#this branching option often helps </span>
    <span class="n">br_tech</span><span class="o">=</span><span class="n">glpk</span><span class="o">.</span><span class="n">GLP_BR_PCH</span><span class="p">,</span> 
<span class="p">)</span>
<span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;status:&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;revenue:&quot;</span><span class="p">,</span> <span class="n">vobj</span><span class="p">(),</span> <span class="s1">&#39;max:&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;schedule:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span>
   <span class="n">start</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span>
   <span class="n">used</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">primal</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;job </span><span class="si">%i</span><span class="s2">:&quot;</span><span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
          <span class="s2">&quot;Accept&quot;</span> <span class="k">if</span> <span class="n">used</span> <span class="k">else</span> <span class="s2">&quot;Reject&quot;</span><span class="p">,</span>
          <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to PyMathProg</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup PyMathProg</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">A Dive-in Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Working with variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="indices.html">Working with Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="pars.html">Working with parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="constr.html">Working with Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvopt.html">Using Solver Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">More Advanced Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#re-optimize-the-assignment">Re-optimize the assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interaction-with-queens">Interaction with queens</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-traveling-sales-man-tsp">The traveling sales man(TSP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zebra-using-string-as-index">Zebra: using string as index</a></li>
<li class="toctree-l2"><a class="reference internal" href="#magic-numbers">Magic numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sudoku-want-some-ai">Sudoku: want some AI?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#super-sudoku">Super Sudoku</a></li>
<li class="toctree-l2"><a class="reference internal" href="#machine-scheduling">Machine Scheduling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scheduling-for-revenue">Scheduling for Revenue</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="subtour.html">Case: Subtour Elimination</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix: Installing MinGW on Windows</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="misc.html" title="Miscellaneous functions"
              >previous</a> |
            <a href="subtour.html" title="Case: Subtour Elimination"
              >next</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/advanced.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Yingjie Lan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>